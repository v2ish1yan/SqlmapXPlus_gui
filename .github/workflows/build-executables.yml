name:  Build  and  Release  Executables

on:
    push:
      branches:
        -  main    #  更改为您想要触发工作流的分支

jobs:
    build-windows:
      runs-on:  windows-latest
      steps:
        -  uses:  actions/checkout@v2
        -  name:  Set  up  Python
           uses:  actions/setup-python@v2
           with:
            python-version:  '3.x'
        -  name:  Install  PyInstaller
           run:  pip  install  pyinstaller
        -  name:  Build  Windows  Executable
           run:  pyinstaller  --onefile  main.py
        -  name:  Create  Release
           id:  create_release
           uses:  actions/create-release@v1
           env:
            GITHUB_TOKEN:  ${{  secrets.GITHUB_TOKEN  }}
           with:
            tag_name:  'v1.0.0'    #  更改为您的版本号
            release_name:  'Windows  Executable'
            draft:  false
            prerelease:  false
        -  name:  Upload  Release  Asset
           uses:  actions/upload-release-asset@v1
           env:
            GITHUB_TOKEN:  ${{  secrets.GITHUB_TOKEN  }}
           with:
            upload_url:  ${{  steps.create_release.outputs.upload_url  }}
            asset_path:  ./dist/main.exe
            asset_name:  main.exe
            asset_content_type:  application/octet-stream

    build-macos:
      runs-on:  macos-latest
      steps:
        -  uses:  actions/checkout@v2
        -  name:  Set  up  Python
           uses:  actions/setup-python@v2
           with:
            python-version:  '3.x'
        -  name:  Install  PyInstaller
           run:  pip  install  pyinstaller
        -  name:  Build  macOS  Executable
           run:  pyinstaller  --onefile  main.py
        -  name:  Create  Release
           id:  create_release
           uses:  actions/create-release@v1
           env:
            GITHUB_TOKEN:  ${{  secrets.GITHUB_TOKEN  }}
           with:
            tag_name:  'v1.0.0'    #  更改为您的版本号
            release_name:  'macOS  Executable'
            draft:  false
            prerelease:  false
        -  name:  Upload  Release  Asset
           uses:  actions/upload-release-asset@v1
           env:
            GITHUB_TOKEN:  ${{  secrets.GITHUB_TOKEN  }}
           with:
            upload_url:  ${{  steps.create_release.outputs.upload_url  }}
            asset_path:  ./dist/main.app
            asset_name:  main.app.zip
            asset_content_type:  application/zip

    build-linux:
      runs-on:  ubuntu-latest
      steps:
        -  uses:  actions/checkout@v2
        -  name:  Set  up  Python
           uses:  actions/setup-python@v2
           with:
            python-version:  '3.x'
        -  name:  Install  PyInstaller
           run:  pip  install  pyinstaller
        -  name:  Build  Linux  Executable
           run:  pyinstaller  --onefile  main.py
        -  name:  Create  Release
           id:  create_release
           uses:  actions/create-release@v1
           env:
            GITHUB_TOKEN:  ${{  secrets.GITHUB_TOKEN  }}
           with:
            tag_name:  'v1.0.0'    #  更改为您的版本号
            release_name:  'Linux  Executable'
            draft:  false
            prerelease:  false
        -  name:  Upload  Release  Asset
           uses:  actions/upload-release-asset@v1
           env:
            GITHUB_TOKEN:  ${{  secrets.GITHUB_TOKEN  }}
           with:
            upload_url:  ${{  steps.create_release.outputs.upload_url  }}
            asset_path:  ./dist/main
            asset_name:  main-linux
            asset_content_type:  application/octet-stream
